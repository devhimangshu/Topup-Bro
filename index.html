<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Top-Up Center</title>

    <!-- Using Tailwind CSS for a modern, utility-first approach -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Inter (Normal Font) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tone.js for Sound Effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    
    <!-- QR Code Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        :root {
            --primary-glow: #00f6ff;
            --background-dark: #0a0f18;
            --container-bg: rgba(15, 25, 45, 0.6);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(-45deg, #0f0c29, #302b63, #24243e, #1c3d52);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: #f0f0f0;
            overflow-x: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .glass-container {
            background: var(--container-bg);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 246, 255, 0.2);
            box-shadow: 0 0 20px rgba(0, 246, 255, 0.1);
            clip-path: polygon(0 0, 100% 0, 100% calc(100% - 15px), calc(100% - 15px) 100%, 0 100%);
        }
        
        .footer-glass-container {
             background: var(--container-bg);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 246, 255, 0.2);
            box-shadow: 0 0 20px rgba(0, 246, 255, 0.1);
        }
        
        .text-glow {
            text-shadow: 0 0 8px var(--primary-glow);
        }
        
        .btn-purchase {
            background: rgba(0, 246, 255, 0.1);
            border: 1px solid rgba(0, 246, 255, 0.5);
            color: #d1e0ff;
            transition: all 0.2s ease-in-out;
            clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
        }
        
        .btn-purchase:hover {
            background: rgba(0, 246, 255, 0.8);
            color: #0a0f18;
            box-shadow: 0 0 15px rgba(0, 246, 255, 0.5);
            transform: translateY(-2px);
        }
        
        /* Item Box Styles */
        .item-box {
            border: 2px solid rgba(0, 246, 255, 0.2);
            transition: all 0.2s ease-in-out;
        }
        .item-box.selected {
            border-color: var(--primary-glow);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 246, 255, 0.3);
        }

        /* Carousel Styles */
        .carousel-slides { transition: transform 0.5s ease-in-out; }
        .carousel-dot.active { background-color: var(--primary-glow); box-shadow: 0 0 5px var(--primary-glow); }
        
        /* Modal Styles */
        .modal-backdrop { background-color: rgba(10, 15, 24, 0.6); -webkit-backdrop-filter: blur(5px); backdrop-filter: blur(5px); }
        
        /* Message Popup Styles */
        .message-popup { transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out; }
        
        .game-banner-bg { background-image: url('https://placehold.co/600x150/d9534f/ffffff?text=FF+Background'); background-size: cover; background-position: center; }
        
        /* Hide arrows from number input */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* Sticky Footer Animation */
        .sticky-footer-container {
            transition: transform 0.3s ease-in-out;
        }
        
        #qrcode-container {
            background: white;
            padding: 10px;
            border-radius: 8px;
        }
    </style>
</head>
<body class="text-white">
<div class="max-w-md mx-auto pb-24"> <!-- Added padding-bottom to prevent content from being hidden by sticky footer -->
    <!-- Sticky Header Section -->
    <header class="sticky top-0 z-50 glass-container">
        <div class="mx-auto p-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <img src="https://cdngarenanow-a.akamaihd.net/webmain/static/images/logo-garena.png" alt="Garena Logo" class="h-7"/>
                <span class="text-md font-semibold text-gray-200 text-glow hidden sm:block">Official Top Up Center</span>
            </div>
            <div id="user-icon-container" class="relative">
                 <div id="default-user-icon" class="w-8 h-8 rounded-full flex items-center justify-center bg-gray-700/50 border border-gray-500/50">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                </div>
            </div>
        </div>
    </header>

    <!-- Interactive Carousel Banner Section -->
    <div id="banner-carousel" class="mx-auto px-2 my-3 relative">
        <div class="w-full rounded-lg overflow-hidden shadow-lg">
            <div class="carousel-slides flex">
                <div class="w-full flex-shrink-0"><img src="https://placehold.co/600x250/24243e/e0e0e0?text=Naruto+Event" alt="Event Banner 1" class="w-full h-auto max-h-48 object-cover"></div>
                <div class="w-full flex-shrink-0"><img src="https://placehold.co/600x250/302b63/e0e0e0?text=Diamond+Discount" alt="Event Banner 2" class="w-full h-auto max-h-48 object-cover"></div>
                <div class="w-full flex-shrink-0"><img src="https://placehold.co/600x250/0f0c29/e0e0e0?text=New+Season" alt="Event Banner 3" class="w-full h-auto max-h-48 object-cover"></div>
            </div>
        </div>
        <button id="prev-slide" class="absolute top-1/2 left-4 -translate-y-1/2 bg-black/30 p-1 rounded-full text-white hover:bg-black/50 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
        <button id="next-slide" class="absolute top-1/2 right-4 -translate-y-1/2 bg-black/30 p-1 rounded-full text-white hover:bg-black/50 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></button>
        <div id="carousel-dots" class="absolute bottom-2 left-1/2 -translate-x-1/2 flex space-x-2"></div>
    </div>
    
    <!-- Post-Login Game Banner -->
    <div id="game-banner" class="mx-auto px-2 my-3 hidden">
        <div class="w-full rounded-lg overflow-hidden shadow-lg game-banner-bg p-4 flex flex-col justify-between h-28 relative">
             <div class="absolute inset-0 bg-black/40"></div>
             <div class="relative z-10 flex items-center space-x-3">
                 <img src="https://placehold.co/100x100/d9534f/ffffff?text=FF" class="rounded-lg h-12 w-12 border-2 border-white/50">
                 <h2 class="text-lg font-bold text-white text-glow">Free Fire</h2>
             </div>
             <div class="relative z-10 flex items-center space-x-2 text-xs bg-black/50 rounded-full px-3 py-1 self-start">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-green-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                 <span>100% Secure Payment</span>
             </div>
        </div>
    </div>

    <!-- Game Selection Section -->
    <div id="game-selection" class="mx-auto p-2">
        <div class="glass-container p-4">
            <h2 class="text-md font-bold text-glow mb-4">Game Selection</h2>
            <div class="grid grid-cols-4 gap-4 text-center text-xs font-semibold">
                <div id="free-fire-btn" class="cursor-pointer hover:opacity-80 transition-opacity"><img src="https://placehold.co/100x100/d9534f/ffffff?text=FF" class="rounded-xl mx-auto mb-2 border-2 border-red-400"><p>Free Fire</p></div>
                <div class="coming-soon-btn cursor-pointer hover:opacity-80 transition-opacity"><img src="https://placehold.co/100x100/1c3d52/e0e0e0?text=Shell" class="rounded-xl mx-auto mb-2"><p>Shell Top Up</p></div>
                <div class="coming-soon-btn cursor-pointer hover:opacity-80 transition-opacity"><img src="https://placehold.co/100x100/1c3d52/e0e0e0?text=AOV" class="rounded-xl mx-auto mb-2"><p>Garena AOV</p></div>
                <div class="coming-soon-btn cursor-pointer hover:opacity-80 transition-opacity"><img src="https://placehold.co/100x100/1c3d52/e0e0e0?text=SD" class="rounded-xl mx-auto mb-2"><p>Speed Drifters</p></div>
            </div>
        </div>
    </div>

    <!-- Main Content: Top-Up List -->
    <div id="top-up-list" class="mx-auto p-2 pb-12 hidden">
        <div class="glass-container p-4">
            <h2 class="text-md font-bold text-glow mb-4">Select Top-Up Amount</h2>
            <div id="item-grid" class="grid grid-cols-2 gap-3">
                <!-- Items will be injected by JS -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer id="main-footer" class="text-center py-4"><div class="space-y-3"><div><a href="#" class="px-2 text-xs hover:text-white transition-colors"></a></div><hr class="border-gray-500/30 max-w-xs mx-auto"><p class="text-xs px-4"></p><div class="text-xs space-x-3"><a href="#" class="hover:text-white transition-colors"></a><a href="#" class="hover:text-white transition-colors"></a><a href="#" class="hover:text-white transition-colors"></a></div></div></footer>
</div>

<!-- Sticky Footer for Selection -->
<div id="sticky-footer" class="sticky-footer-container fixed bottom-0 left-0 w-full z-40 transform translate-y-full">
    <div class="footer-glass-container max-w-md mx-auto rounded-lg p-3 m-2 flex justify-between items-center">
        <div class="flex items-center">
            <img id="footer-product-icon" src="" class="h-8 mr-3" alt="Item Icon">
            <div>
                <p id="footer-product-name" class="font-bold text-sm"></p>
                <p id="footer-product-price" class="text-xs text-gray-300"></p>
            </div>
        </div>
        <button id="buy-now-btn" class="btn-purchase font-bold py-2 px-6 text-sm">Buy Now</button>
    </div>
</div>


<!-- Player ID Login Modal -->
<div id="login-modal" class="fixed inset-0 z-[110] flex items-center justify-center p-4 modal-backdrop hidden"><div class="glass-container w-full max-w-sm"><div class="p-4 border-b border-[var(--primary-glow)]/20 flex justify-between items-center"><h3 class="text-lg font-bold text-glow">Enter Player ID</h3><button id="close-modal-btn" class="text-gray-300 hover:text-white text-2xl">&times;</button></div><div class="p-6 space-y-4"><p id="login-error" class="text-red-400 text-sm hidden">Player ID must be 10 digits.</p><input id="player-id-input" type="number" placeholder="Please enter your Player ID" class="w-full bg-black/20 border border-gray-500/50 rounded-lg p-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[var(--primary-glow)]"><button id="login-btn" class="w-full btn-purchase font-bold py-3 rounded-lg">Login</button></div></div></div>

<!-- User Menu Modal -->
<div id="user-menu-modal" class="fixed inset-0 z-[110] flex items-center justify-center p-4 modal-backdrop hidden">
    <div class="glass-container w-full max-w-sm">
        <div class="p-4 border-b border-[var(--primary-glow)]/20 flex justify-between items-center">
            <h3 class="text-lg font-bold text-glow">Player Info</h3>
            <button id="close-user-menu-btn" class="text-gray-300 hover:text-white text-2xl">&times;</button>
        </div>
        <div id="user-menu-content" class="p-6 space-y-4 text-sm"></div>
    </div>
</div>

<!-- Payment Modal -->
<div id="payment-modal" class="fixed inset-0 z-[110] flex items-center justify-center p-4 modal-backdrop hidden">
    <div class="glass-container w-full max-w-sm text-center">
        <div class="p-4 border-b border-[var(--primary-glow)]/20 flex justify-between items-center">
            <h3 class="text-lg font-bold text-glow">Complete Payment</h3>
            <button id="close-payment-modal-btn" class="text-gray-300 hover:text-white text-2xl">&times;</button>
        </div>
        <div class="p-6 space-y-3">
            <div id="order-details" class="text-left text-xs space-y-2 mb-4"></div>
            <div id="qrcode-container" class="w-48 h-48 mx-auto flex items-center justify-center"></div>
            <p class="text-sm">Scan the QR code with your UPI app</p>
            <div id="payment-timer" class="text-2xl font-bold text-[var(--primary-glow)]">05:00</div>
            <p class="text-xs text-gray-400">This code will expire in 5 minutes.</p>
        </div>
    </div>
</div>

<!-- Message Popup -->
<div id="message-popup" class="fixed top-20 left-1/2 -translate-x-1/2 z-[110] hidden message-popup opacity-0 transform scale-95"><div class="glass-container p-4 text-center"><p id="message-popup-text"></p></div></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Sound Effects ---
            const synth = new Tone.Synth().toDestination();
            const playClickSound = () => synth.triggerAttackRelease("C2", "8n");
            const playLoginSound = () => synth.triggerAttackRelease("C4", "8n");
            const playMessageSound = () => synth.triggerAttackRelease("E3", "8n");
            
            // MOBILE FIX: Ensure audio context is started by a user gesture.
            let audioStarted = false;
            function startAudio() {
                if (!audioStarted) {
                    Tone.start();
                    audioStarted = true;
                }
            }
            document.body.addEventListener('click', startAudio, { once: true });
            document.body.addEventListener('touchstart', startAudio, { once: true });

            document.querySelectorAll('button:not(#login-btn), #free-fire-btn').forEach(btn => {
                btn.addEventListener('click', playClickSound);
            });

            // --- Main Application Logic ---
            const gameSelection = document.getElementById('game-selection');
            const topUpList = document.getElementById('top-up-list');
            const loginModal = document.getElementById('login-modal');
            const freeFireBtn = document.getElementById('free-fire-btn');
            const loginBtn = document.getElementById('login-btn');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const playerIdInput = document.getElementById('player-id-input');
            const userIconContainer = document.getElementById('user-icon-container');
            const comingSoonBtns = document.querySelectorAll('.coming-soon-btn');
            const messagePopup = document.getElementById('message-popup');
            const messagePopupText = document.getElementById('message-popup-text');
            const bannerCarousel = document.getElementById('banner-carousel');
            const gameBanner = document.getElementById('game-banner');
            const loginError = document.getElementById('login-error');
            const userMenuModal = document.getElementById('user-menu-modal');
            const userMenuContent = document.getElementById('user-menu-content');
            const closeUserMenuBtn = document.getElementById('close-user-menu-btn');
            const mainFooter = document.getElementById('main-footer');
            const stickyFooter = document.getElementById('sticky-footer');
            const footerProductName = document.getElementById('footer-product-name');
            const footerProductPrice = document.getElementById('footer-product-price');
            const footerProductIcon = document.getElementById('footer-product-icon');
            const buyNowBtn = document.getElementById('buy-now-btn');
            const itemGrid = document.getElementById('item-grid');
            const paymentModal = document.getElementById('payment-modal');
            const closePaymentModalBtn = document.getElementById('close-payment-modal-btn');
            const qrcodeContainer = document.getElementById('qrcode-container');
            const paymentTimerDisplay = document.getElementById('payment-timer');
            const orderDetails = document.getElementById('order-details');

            let defaultUserIconHTML = userIconContainer.innerHTML;
            let loggedInPlayerId = null;
            let paymentTimerInterval;

            const itemsData = [
                { name: '100 + 100 Diamond', displayName: '100 Diamond', price: '₹80', type: 'Diamond', icon: 'https://cdngarenanow-a.akamaihd.net/gop/app/0000/100/067/point.png' },
                { name: '310 + 310 Diamond', displayName: '310 Diamond', price: '₹240', type: 'Diamond', icon: 'https://cdngarenanow-a.akamaihd.net/gop/app/0000/100/067/point.png' },
                { name: '520 + 520 Diamond', displayName: '520 Diamond', price: '₹400', type: 'Diamond', icon: 'https://cdngarenanow-a.akamaihd.net/gop/app/0000/100/067/point.png' },
                { name: '1060 + 1060 Diamond', displayName: '1060 Diamond', price: '₹800', type: 'Diamond', icon: 'https://cdngarenanow-a.akamaihd.net/gop/app/0000/100/067/point.png' },
                { name: '2180 + 2180 Diamond', displayName: '2180 Diamond', price: '₹1,600', type: 'Diamond', icon: 'https://cdngarenanow-a.akamaihd.net/gop/app/0000/100/067/point.png' },
                { name: '5600 + 5600 Diamond', displayName: '5600 Diamond', price: '₹4,000', type: 'Diamond', icon: 'https://cdngarenanow-a.akamaihd.net/gop/app/0000/100/067/point.png' },
                { name: 'Weekly Membership', displayName: 'Weekly Membership', price: '₹159', type: 'Voucher', icon: 'https://html-generator.com/uploads/images/2021/12/12/69338PCBY_LHZ1K.png' },
                { name: 'Monthly Membership', displayName: 'Monthly Membership', price: '₹799', type: 'Voucher', icon: 'https://html-generator.com/uploads/images/2021/12/12/69338PCBY_LHZ1K.png' },
            ];

            function populateItems() {
                itemGrid.innerHTML = '';
                itemsData.forEach((item, index) => {
                    const itemBox = document.createElement('div');
                    itemBox.className = 'item-box p-2 rounded-lg text-center cursor-pointer transition-all';
                    itemBox.dataset.index = index;
                    itemBox.innerHTML = `
                        <img src="${item.icon}" class="h-8 mx-auto mb-1">
                        <p class="font-semibold text-xs text-glow">${item.name.replace('Diamond', '').replace('Membership', '')}</p>
                        <p class="text-xs text-gray-400">${item.type}</p>
                        <div class="mt-2 bg-cyan-900/50 text-cyan-300 text-xs font-bold py-1 rounded-md">${item.price}</div>
                    `;
                    itemGrid.appendChild(itemBox);
                });
                initializeItemSelection();
            }

            function initializeItemSelection() {
                const itemBoxes = document.querySelectorAll('.item-box');
                let selectedItem = null;

                itemBoxes.forEach(box => {
                    box.addEventListener('click', () => {
                        if (selectedItem === box) {
                            box.classList.remove('selected');
                            selectedItem = null;
                            stickyFooter.style.transform = 'translateY(100%)';
                        } else {
                            itemBoxes.forEach(b => b.classList.remove('selected'));
                            box.classList.add('selected');
                            selectedItem = box;
                            
                            const itemData = itemsData[box.dataset.index];
                            footerProductName.textContent = itemData.displayName;
                            footerProductPrice.textContent = `Total: ${itemData.price}`;
                            footerProductIcon.src = itemData.icon;
                            buyNowBtn.dataset.index = box.dataset.index;
                            stickyFooter.style.transform = 'translateY(0)';
                        }
                    });
                });
            }

            function showPaymentModal(item) {
                const date = new Date();
                const orderId = `GNA-${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2,'0')}${date.getDate().toString().padStart(2,'0')}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`;
                const amount = item.price.replace('₹', '').replace(',', '');
                const upiString = `upi://pay?pa=keyapaul@fifederal&pn=Gshopindia&am=${amount}&cu=INR&tn=${orderId}`;
                
                orderDetails.innerHTML = `
                    <div class="flex justify-between"><span class="text-gray-400">Order ID:</span> <span class="font-mono">${orderId}</span></div>
                    <div class="flex justify-between"><span class="text-gray-400">Player ID:</span> <span class="font-mono">${loggedInPlayerId}</span></div>
                    <div class="flex justify-between"><span class="text-gray-400">Item:</span> <span class="font-bold">${item.displayName}</span></div>
                    <div class="flex justify-between text-lg mt-2 pt-2 border-t border-[var(--primary-glow)]/20"><span class="text-gray-400">Total:</span> <span class="font-bold text-[var(--primary-glow)]">${item.price}</span></div>
                `;

                qrcodeContainer.innerHTML = ''; // Clear previous QR code
                new QRCode(qrcodeContainer, { text: upiString, width: 180, height: 180 });

                paymentModal.classList.remove('hidden');
                startPaymentTimer();
            }

            function startPaymentTimer() {
                let duration = 300; // 5 minutes
                clearInterval(paymentTimerInterval);
                paymentTimerInterval = setInterval(() => {
                    const minutes = Math.floor(duration / 60).toString().padStart(2, '0');
                    const seconds = (duration % 60).toString().padStart(2, '0');
                    paymentTimerDisplay.textContent = `${minutes}:${seconds}`;
                    if (--duration < 0) {
                        clearInterval(paymentTimerInterval);
                        paymentModal.classList.add('hidden');
                        showMessage('Payment session expired.');
                    }
                }, 1000);
            }

            buyNowBtn.addEventListener('click', () => {
                const itemIndex = buyNowBtn.dataset.index;
                if (itemIndex) {
                    showPaymentModal(itemsData[itemIndex]);
                }
            });
            closePaymentModalBtn.addEventListener('click', () => {
                clearInterval(paymentTimerInterval);
                paymentModal.classList.add('hidden');
            });


            function showMessage(text, duration = 2000) {
                playMessageSound();
                messagePopupText.textContent = text;
                messagePopup.classList.remove('hidden');
                setTimeout(() => { messagePopup.classList.remove('opacity-0', 'scale-95'); messagePopup.classList.add('opacity-100', 'scale-100'); }, 10);
                setTimeout(() => { messagePopup.classList.remove('opacity-100', 'scale-100'); messagePopup.classList.add('opacity-0', 'scale-95'); setTimeout(() => messagePopup.classList.add('hidden'), 300); }, duration);
            }

            freeFireBtn.addEventListener('click', () => loginModal.classList.remove('hidden'));
            closeModalBtn.addEventListener('click', () => loginModal.classList.add('hidden'));
            closeUserMenuBtn.addEventListener('click', () => userMenuModal.classList.add('hidden'));
            comingSoonBtns.forEach(btn => btn.addEventListener('click', () => { playClickSound(); showMessage('Coming Soon!'); }));
            
            loginBtn.addEventListener('click', () => {
                const playerId = playerIdInput.value.trim();
                const validPlayerId = /^\d{10}$/;
                if (validPlayerId.test(playerId)) {
                    playLoginSound();
                    loggedInPlayerId = playerId;
                    loginError.classList.add('hidden');
                    loginModal.classList.add('hidden');
                    gameSelection.classList.add('hidden');
                    bannerCarousel.classList.add('hidden');
                    mainFooter.classList.add('hidden');
                    gameBanner.classList.remove('hidden');
                    topUpList.classList.remove('hidden');
                    populateItems();
                    updateUserMenu(playerId);
                } else {
                    loginError.classList.remove('hidden');
                    playerIdInput.focus();
                }
            });

            function updateUserMenu(playerId) {
                const loggedInIconHTML = `<div id="logged-in-icon" class="w-8 h-8 rounded-full flex items-center justify-center bg-gray-700/50 border border-green-400/50 cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg></div>`;
                userIconContainer.innerHTML = loggedInIconHTML;

                const userMenuContentHTML = `
                    <div class="space-y-1"><p class="text-xs text-gray-400">Player ID:</p><p class="font-bold truncate">${playerId}</p></div>
                    <div class="border-t border-[var(--primary-glow)]/20 my-3"></div>
                    <div class="space-y-1"><p class="text-xs text-gray-400">Server:</p><div class="flex items-center"><svg class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_303_3)"><path d="M0 0H24V24H0V0Z" fill="white" fill-opacity="0.01"/><path d="M21 2H3C2.44772 2 2 2.44772 2 3V21C2 21.5523 2.44772 22 3 22H21C21.5523 22 22 21.5523 22 21V3C22 2.44772 21.5523 2 21 2Z" fill="#F0F0F0"/><path d="M21 2H3C2.44772 2 2 2.44772 2 3V8H22V3C22 2.44772 21.5523 2 21 2Z" fill="#FF9933"/><path d="M2 16H22V21C22 21.5523 21.5523 22 21 22H3C2.44772 22 2 21.5523 2 21V16Z" fill="#128807"/><path d="M12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14Z" stroke="#000080" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round"/></g><defs><clipPath id="clip0_303_3"><rect width="24" height="24" fill="white"/></clipPath></defs></svg><span>India</span></div></div>
                    <div class="border-t border-[var(--primary-glow)]/20 my-3"></div>
                    <button id="logout-btn" class="w-full text-center p-2 text-red-400 hover:bg-white/10 rounded-md border border-red-400/50">Logout</button>`;
                userMenuContent.innerHTML = userMenuContentHTML;

                document.getElementById('logged-in-icon').addEventListener('click', () => userMenuModal.classList.remove('hidden'));
                document.getElementById('logout-btn').addEventListener('click', logout);
            }

            function logout() {
                userMenuModal.classList.add('hidden');
                topUpList.classList.add('hidden'); 
                gameBanner.classList.add('hidden'); 
                gameSelection.classList.remove('hidden'); 
                bannerCarousel.classList.remove('hidden'); 
                mainFooter.classList.remove('hidden');
                stickyFooter.style.transform = 'translateY(100%)';
                userIconContainer.innerHTML = defaultUserIconHTML; 
                playerIdInput.value = '';
                loggedInPlayerId = null;
            }

            // Carousel Logic
            const carousel = document.getElementById('banner-carousel');
            const slidesContainer = carousel.querySelector('.carousel-slides');
            const slides = Array.from(slidesContainer.children);
            const nextButton = document.getElementById('next-slide');
            const prevButton = document.getElementById('prev-slide');
            const dotsContainer = document.getElementById('carousel-dots');
            let currentIndex = 0, slideInterval, slideCount = slides.length;
            slides.forEach((_, i) => { const dot = document.createElement('button'); dot.classList.add('carousel-dot', 'w-2', 'h-2', 'bg-white/50', 'rounded-full', 'transition-colors'); dot.addEventListener('click', () => { goToSlide(i); resetInterval(); }); dotsContainer.appendChild(dot); });
            const dots = Array.from(dotsContainer.children);
            const goToSlide = (index) => { slidesContainer.style.transform = `translateX(-${index * 100}%)`; dots.forEach(dot => dot.classList.remove('active')); dots[index].classList.add('active'); currentIndex = index; };
            const nextSlide = () => goToSlide((currentIndex + 1) % slideCount);
            const prevSlide = () => goToSlide((currentIndex - 1 + slideCount) % slideCount);
            const startInterval = () => slideInterval = setInterval(nextSlide, 5000);
            const resetInterval = () => { clearInterval(slideInterval); startInterval(); };
            nextButton.addEventListener('click', () => { nextSlide(); resetInterval(); });
            prevButton.addEventListener('click', () => { prevSlide(); resetInterval(); });
            let isDragging = false, startPos = 0, currentTranslate = 0, prevTranslate = 0, animationID, carouselWidth = carousel.offsetWidth;
            const getPositionX = e => e.type.includes('mouse') ? e.pageX : e.touches[0].clientX;
            const dragStart = (e) => { isDragging = true; startPos = getPositionX(e); animationID = requestAnimationFrame(animation); slidesContainer.style.transition = 'none'; resetInterval(); carouselWidth = carousel.offsetWidth; };
            const dragMove = (e) => { if (isDragging) { const currentPosition = getPositionX(e); currentTranslate = prevTranslate + currentPosition - startPos; } };
            const dragEnd = () => { isDragging = false; cancelAnimationFrame(animationID); const movedBy = currentTranslate - prevTranslate; if (movedBy < -carouselWidth / 4 && currentIndex < slideCount - 1) currentIndex++; if (movedBy > carouselWidth / 4 && currentIndex > 0) currentIndex--; goToSlide(currentIndex); slidesContainer.style.transition = 'transform 0.5s ease-in-out'; prevTranslate = -currentIndex * carouselWidth; currentTranslate = prevTranslate; };
            function animation() { slidesContainer.style.transform = `translateX(${currentTranslate}px)`; if (isDragging) requestAnimationFrame(animation); }
            function setPositionByIndex() { currentTranslate = currentIndex * -carouselWidth; prevTranslate = currentTranslate; slidesContainer.style.transform = `translateX(${currentTranslate}px)`; }
            carousel.addEventListener('mousedown', dragStart);
            carousel.addEventListener('touchstart', dragStart, { passive: true });
            carousel.addEventListener('mouseup', dragEnd);
            carousel.addEventListener('touchend', dragEnd);
            carousel.addEventListener('mouseleave', dragEnd);
            carousel.addEventListener('mousemove', dragMove);
            carousel.addEventListener('touchmove', dragMove, { passive: true });
            window.addEventListener('resize', () => { carouselWidth = carousel.offsetWidth; setPositionByIndex(); });
            goToSlide(0);
            startInterval();
        });
    </script>

</body>
</html>
